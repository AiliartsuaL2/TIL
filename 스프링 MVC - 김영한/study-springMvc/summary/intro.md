- 웹서버
    - Http 기반으로 동작
    - 정적인 리소스를 제공,
    - Html, Css, Js, 이미지, 영상 등
    - 아파치 등
- 웹 애플리케이션 서버 (WAS)
    - Http 기반 동작
    - 웹서버 기능 + 동적 기능(프로그램 코드 실행,, 로직 수행 가능)
    - 동적 HTML, Rest API(JSON)
    - 서블릿, JSP, 스프링 MVC 사용,,
    - 톰캣 등
- 자바의 경우 서블릿 컨테이너 기능을 제공하면 WAS
- WAS는 애플리케이션 코드를 실행하는데 더 특화 되어있음
- WAS에 모든게 들어있는 통합 환경의 경우 (WAS + DB)
    - WAS가 너무 많은 역할을 담당하는경우 서버가 과부하 될 수 있음,,
    - 가치가 있는 비즈니스 로직들이 정적 리소스때문에 수행이 어려울 수 있음,,
    - WAS 장애시 오류 화면도 노출이 불가능하다.

일반적인 웹 시스템 구성 (WEB, WAS, DB)
- 정적 리소스는 웹서버가 처리하고
- 웹 서버는 애플리케이션 로직과같은 동적인 처리가 필요한 경우 WAS에 요청을 위임한다.
- WAS는 중요한 애플리케이션 로직 처리를 전담한다.

서블릿
- 개발자가 요청과 응답사이의 의미있는 비즈니스 로직만 작성 할 수 있도록 자동화해줌
- TCP/IP 연결 HTTP 메서드, url 파싱 등의 전처리 후처리,,
- HttpServletRequest : 요청 정보를 편하게 사용하도록
- HttpServletResponse : 응답정보를 편하게 제공하도록,,
- 개발자는 HTTP 스펙을 매우 편리하게 사용할 수 있음,,
- 서블릿 컨테이너
    - 서블릿을 지원하는 컨테이너,, 서블릿 객체를 생성,호출,생명주기등을 관리해줌.
    - 서블릿 객체는 싱글톤으로 관리
        - 공유 변수 사용을 주의해야함
        - 서블릿 컨테이너 종료시 함께 종료
    - JSP도 서블릿으로 변환되어 사용된다.
    - 동시 요청을 위한 멀티 쓰레드 처리를 지원한다.

동시 요청 - 멀티 쓰레드
- 쓰레드
    - 서블릿 객체는 쓰레드가 호출해줌,,
    - 애플리케이션 코드를 하나하나 순차적으로 실행하는것은 쓰레드
    - main 메서드 실행시, main 이라는 이름의 쓰레드가 실행
    - 쓰레드는 한번에 하나의 코드 라인만 수행
    - 동시 처리가 필요한 경우 (요청이 추가로 들어오면) 쓰레드를 추가로 생성한다.
- 요청마다 쓰레드를 생성하는 경우
    - 장점
        - 동시 요청을 처리 할 수 있다.
        - 리소스가 허용할 때까지 처리가 가능하다.
        - 하나의 쓰레드가 지연되어도, 나머지 쓰레드는 정상적으로 동작한다.
    - 단점
        - 쓰레드 생성 비용은 매우 비쌈
            - 고객의 요청이 올 때마다 쓰레드를 생성하면 응답 속도가 늦어진다.
        - 쓰레드는 컨텍스트 스위칭 비용이 발생한다.
        - 쓰레드 생성에 제한이 없다
            - 고객 요청이 너무 많이 오면 CPU, 메모리 임계점이 넘어가 서버가 죽을 수 있다.
- 쓰레드 풀
    - 쓰레드 풀에 쓰레드를 미리 생성해두고, 요청시 쓰레드 풀에있는 쓰레드를 주고 사용 후 반납시킴
    - 서버의 한계점을 설정 할 수 있음,, (쓰레드풀 꽉 찬경우 쓰레드를 대기하거나 거절 할 수 있음)
    - 톰캣은 최대 200개를 기본적으로 설정함(변경 가능)
    - 미리 생성되어있는 쓰레드를 사용하므로 쓰레드를 생성하고 종료하는 비용이 절약되고, 응답 시간이 빠르다.
    - 생성 가능한 쓰레드의 최대치가 있으므로 많은 요청이 들어와도 기존 요청은 안전하게 처리 가능
    - 실무 팁
        - WAS의 주요 튜닝 포인트는 최대 쓰레드 수 이다.
        - Max Thread 수를 너무 낮게 설정시
            - 동시 요청이 많으면 서버 리소스는 여유롭지만, 클라이언트는 금방 응답이 지연된다.
        - Max Thread 수를 너무 높게 설정시
            - 동시 요청이 많으면 CPU, 메모리 리소스 임계점 초과로 서버가 다운된다.
        - 장애 발생시
            - 클라우드면 일단 서버부터 늘리고, 이후에 튜닝
            - 클라우드가 아니면 열심히 튜닝한다...
    - 적정 숫자는 애플리케이션의 복잡도, CPU, 메모리 등에 따라 모두 다름,,
        - 실제 서비스와 유사한 환경에서 성능 테스트를 해봐야 함
- WAS의 멀티쓰레드 지원
    - 멀티쓰레드에 대한 부분은 WAS가 모두 처리함.
    - 개발자가 멀티 쓰레드 관련 코드를 신경쓰지 않아도 됨. (concurrent 이런거 사용 안해도 된다.)
    - 개발자는 싱글 쓰레드 프로그래밍을 하듯 편리하게 소스 코드를 개발한다.
    - **멀티 쓰레드 환경이므로 싱글톤 객체(스프링 빈)는 주의해서 사용한다**

HTTP API
- HTML로 렌더링 시키는게 아니라 데이터만 보냄(JSON) 시스템간 호출시 사용
- 데이터만 주고받기 때문에 UI 화면이 필요하면 클라이언트가 별도로 처리한다.

서버 사이드 렌더링(SSR)
- 서버에서 최종 HTML을 생성해서 클라이언트에 전달.
- 주로 정적인 화면에 사용
- JSP, 타임리프,,
  클라이언트 사이드 렌더링(CSR)
- HTML 결과를 javascript를 사용해서 웹 브라우저에서 동적으로 생성해서 사용
- 동적인 환경에서 사용,, 지도, 등등,,
- React, Vue.js등으로 사용
